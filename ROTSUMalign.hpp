/* header for structure alignment by chi-1 rotamer */
#ifndef ROTSUMalign_HPP
#define ROTSUMalign_HPP 1

#include <iostream>
#include <vector>
#include <fstream>
#include <string>
#include <string.h>
#include <iomanip>
#include <stdlib.h>
#include <ctype.h>

#include "PDBParser.hpp"
#include "FilePathParser.hpp"
#include "getRotSeq.hpp"
#include "NWalign.hpp"

using namespace std;

void trace_back_gotoh(string seq1, string seq2,
    const vector<vector<int> >& JumpH, const vector<vector<int> >& JumpV,
    const vector<vector<int> >& P, string& aln1, string& aln2);
void trace_back_sw(string seq1, string seq2,
    const vector<vector<int> >& JumpH, const vector<vector<int> >& JumpV,
    const vector<vector<int> >& P, string& aln1, string& aln2);


// in rotsum
const int gapopen_rotsum8=-11;
const int gapext_rotsum8=-1;

const float ROTSUM8[55][55]={
//        A          B          C          D          E          F          G          H          I          J          K          L          M          N          O          P          Q          R          S          T          U          V          W          X          Y          Z          a          b          c          d          e          f          g          h          i          j          k          l          m          n          o          p          q          r          s          t          u          v          w          x          y          z          0          1          2
{   4.01445,  0.792212,  -2.40372,  0.256451,  -1.40267,  -1.22553, -0.958413,   -1.4309, -0.215364, -0.356881,  -1.84156,  -1.05417, -0.263681,    -0.523, -0.589897, -0.366575,  -1.24462,  -1.01733, -0.542472,  -1.17683, -0.619156, -0.856383,  -0.84729, -0.520294,  -1.45941,  -1.38201,  -1.25644, -0.662174,  -1.30431,  -1.54496, -0.710108,  -1.85873, -0.599115, -0.587776, -0.542945, -0.378522,  -1.12827, -0.380895,  -0.40113, -0.892847, -0.707997, -0.576223,-0.0667358,  -1.21754,  -0.84387, -0.793213,   0.53968, -0.768414, -0.381107,  -2.16586,  -3.24808,  -3.55613,  -1.73313,  -1.99479,  -2.09109},//A
{  0.792212,   12.3491,   8.74974,   4.36264,   -3.5432,   -5.9241,  -6.94603,  -1.58459,  0.731107,     -1.99,  -1.61765,  -4.40349, -0.278052,  -5.69079,  -1.78762,  -6.24416,  -4.20465,  -1.08653,  -3.85402,  -5.86721,  -4.08167,  -9.35301,  -6.27927,  -4.44116,  -5.73266,  -6.06519,  -2.37246,  -6.00596,  -6.36284,  -1.90371,  -4.21859, -0.740854,  -6.23108,  -6.44222,  -5.09919,   -5.8512,  -5.27616,  -5.60902,  -1.16259,  -5.31862,  -3.63179,  -5.34387,  -5.15304,  -3.27618,  -2.59388,  -6.99954,  -2.54156,  -2.08049,   -1.7427,  -2.89796,  -7.84024,  -9.72281,  -3.07319,  -6.44478,   2.69856},//B
{  -2.40372,   8.74974,   11.8371,   7.18748,  -6.24916,  -5.99351,  -6.83679,  -2.77396, -0.744139,  -3.28552,  -3.37116,  -3.55657,  -1.58182,  -6.36616,  -4.27709,  -4.03771,  -4.28319,  -4.06757,  -4.59938,  -3.61591,  -6.65841,  -6.28973,  -6.90186,  -6.32584,  -1.94781,  -4.56902,   -4.8667,   -2.7016,  -5.08329,  -3.49918,  -3.52943,  -1.96243,  -5.91844,  -5.73614,  -7.36203,  -6.16515,  -6.47549,    -6.526,  -2.32323,  -5.79972,  -4.22682,  -2.48423,  -4.45388,   -2.4155,   -3.6858,  -2.77351,  -3.00941,  -2.12316,  -4.48156,  -4.04859,  -5.02397,  -8.35416,  -6.28559,  -5.40876, -0.593343},//C
{  0.256451,   4.36264,   7.18748,   11.9029,  -3.47865,  -3.56037,  -3.91702,  -1.96113,  -2.95679,   -2.7431,  -1.95231,  -1.44056, -0.609867,  -2.74774,  -2.62089,  -3.18183,  -2.45334, -0.416104,  -3.58651, -0.519116,  -2.34691,  -4.77542,   -3.6374,  -5.41625,  -1.19273, -0.111905,   -1.8837,  -1.38403,   1.16089,  -2.11154,  -1.56858,  -1.99305,  -4.23194,  -3.55707,  -3.08448,  -5.02358,  -3.92134,  -4.00291,  -2.95476,  -1.76834,  -2.81874,  -2.22222,    -1.333,  -2.08366,  -3.09499,  -2.76545,  -2.19687, -0.594667,  -1.31017,  -3.31732,  -4.46695,  -3.99073,  -3.23081,  -3.44479,  -2.08175},//D
{  -1.40267,   -3.5432,  -6.24916,  -3.47865,   10.2833,   3.56862,   2.77314,   2.70943,  0.116993,  0.601702,  -3.37935,  -3.32166, -0.272907, -0.307577,   1.44813,  -3.03039,  -1.77726,  -2.03189,  -3.21678,  -4.33214, -0.566338,  -3.09523,   -1.8027,  -2.76361,  -5.05887,  -3.17726,  -2.70905,  -4.13257,  -3.20498,   4.32471, -0.309682, -0.641163,  -1.66849,  -1.37151, -0.959962,  -2.58651, -0.461428, -0.758728,  -2.05436, -0.587561,   0.87419,  -1.03011,  -1.12771,   1.31917, -0.987373,  -2.72215,  -2.70379,   -4.0481,  -2.37519,  0.254297,  -2.88694,  -2.18233,   0.63188,   -1.2142, -0.771218},//E
{  -1.22553,   -5.9241,  -5.99351,  -3.56037,   3.56862,   9.03109,   1.64144,  0.191647,   1.41024,  0.557789,  -2.26972,   -2.2298,  -3.12161,  -1.10233,  0.033079,  0.545603,  -1.10866,  -2.50656,   -2.5511,   -3.6773, -0.770551,  -2.04867, -0.846579,  -2.12621,  -2.27353,  -3.13669,  -3.78095,  -2.98349,  -3.19996,   0.58073,   3.46123, -0.765591,  -1.64122,    -1.802,  0.013647, -0.863165,-0.0515525,  -1.97371, -0.803408, -0.593555,  0.436727,   1.45142,  -1.21531,  -1.30207,  -0.63213,  -2.41821,  -3.94435,  -4.05658,  -3.40064,  -2.37397,  -1.78507,  -5.02255, 0.0670789,  -0.53254,   -3.3819},//F
{ -0.958413,  -6.94603,  -6.83679,  -3.91702,   2.77314,   1.64144,   7.10102,   3.10646,   1.70069,   2.20177, -0.756596,  -2.51937,  -3.61241, -0.868897, -0.929896,  -1.76896, -0.280569,  -2.08801,  -2.11425,  -3.14941, -0.931346,  -1.14325, -0.338489,  -5.59245,  -4.71034,  -3.82743,   -3.7552,  -2.63152,  -2.81867, -0.548396, -0.969777,    1.4584,  -1.18925, -0.457086,  -0.93244,  -1.12949,  0.579513,  -2.31426,  -1.12138, -0.507812,  -0.78156,  -1.18253, -0.354934,  -1.67496,  -2.34843,  -1.18159,  -2.80397,  -2.45356,   -2.7005,  -3.20405,  -4.55336,  -4.05776,   -2.0004,  -2.72427,  -3.19591},//G
{   -1.4309,  -1.58459,  -2.77396,  -1.96113,   2.70943,  0.191647,   3.10646,   8.68247,   4.18687,     4.766,   0.49691,   -3.9865,   -4.0501,   -1.6889,   1.22392,  -2.16573, -0.839336,  -2.50672,  -2.90699,  -2.90047,   1.26958, -0.320017,  -0.12639,  -3.10019,  -3.98584,      -3.8,  0.478879,   -2.9214,   -2.5541,  0.304894,   -1.5984, -0.816637,  -1.52581,  -1.14616,   1.63978, -0.299036,  0.710169, -0.443492, -0.856816,  -0.89532,0.00920898,  -1.37553,  -1.57104,  -1.42442,  -1.40657, -0.261627,  -1.92586,  -2.87994,  -1.92477,  0.689124,  -3.37187,    -2.761,   2.18682,  -2.88563,  -4.87703},//H
{ -0.215364,  0.731107, -0.744139,  -2.95679,  0.116993,   1.41024,   1.70069,   4.18687,   6.76607,   4.02419,  -2.49734,  -1.62379,  -4.09637,  -2.38775, -0.788599,-0.0926523, -0.484018,  -2.95383,  -3.48145,  -2.52579,  0.584527,   1.60628,  0.538962,  -3.39113,  -2.23563,  -3.16181,  -2.26274,  -1.51514,  -1.71169, -0.939391, -0.364481,  0.215488,  -1.86291,  -1.17278,  0.427558,   1.94845,  0.865648,  -1.19853,   1.54876,  0.365061,  -1.46387,  -1.68082,   -1.3721,  -2.13539,  -1.75433,  -0.34583,  -2.74857,   -2.4265,  -2.78757,  -2.78234,  -1.77986,  -5.34812,  -1.61693,  -1.19877,  -4.65681},//I
{ -0.356881,     -1.99,  -3.28552,   -2.7431,  0.601702,  0.557789,   2.20177,     4.766,   4.02419,   5.90083, -0.549655,   -2.9327,  -2.92275,  -1.45612, -0.760489,  -1.09074,  0.792935,  -2.62731,  -2.85023,  -3.41412,  0.653289,  0.236321,  0.612041,  -2.21034,   -3.3065,  -2.42944,  -1.59684,  -2.50653,  -1.74946, -0.877363,  -1.22712,-0.0163272, -0.260025,  -1.27195, -0.268439, 0.0606709,   2.18072,  -1.23447,  0.234219,  0.388812, -0.536578,  -1.34248,  -1.42728,  -1.31784,  -2.30724,  -1.37169,  -2.72093,  -3.10693,  -1.62517,  -3.11496,  -1.37572,  -3.27374,   -4.3262,  -2.69496,  -3.34833},//J
{  -1.84156,  -1.61765,  -3.37116,  -1.95231,  -3.37935,  -2.26972, -0.756596,   0.49691,  -2.49734, -0.549655,     12.22,   1.52307,  0.565183,  -1.64096,  0.911373,  -4.36568,    -1.971,   1.79822, -0.295748, -0.683873,  -3.05715,  -5.88776,  -5.78102,  0.905025,  -2.00769,  -2.39897,   1.41431,  -1.90103,   -1.2553,  -1.39781,  -2.17315,  -2.52992,  -4.27902,  -4.68945, 0.0904811,  -4.53017,  -3.44047,  -3.60017,  -4.51958,  -3.40334,  -1.22467,  -2.40103,  -3.01157,  -3.67927,  -1.74178,  -4.37346,  0.320618,    -1.423,  0.034443,   5.08762,  -3.01818,  -1.14988,   8.94699,   1.02974,  -1.02556},//K
{  -1.05417,  -4.40349,  -3.55657,  -1.44056,  -3.32166,   -2.2298,  -2.51937,   -3.9865,  -1.62379,   -2.9327,   1.52307,   9.67256, -0.133009,  -3.59091,  -2.08763,  0.770579, -0.377352,   1.38048,   1.20909,-0.0877617,  -2.39202,  -2.65087,   -3.3524,  -2.30898,   2.12914, -0.970875,  -2.06643,   2.11074, -0.878482,  -3.49419,  -1.15262,  -3.61917,  -2.08128,  -2.73383,  -1.02917,  -2.09141,  -2.77261,  -3.56285,  -1.63225,  -2.57278,   -2.5724,  -1.15618,  -3.24697,  -3.69904,  -2.15676,  -2.44832,  -1.42923, -0.988032,  -1.74472, -0.631505,   3.92058,  -2.47021, -0.733596,   7.38787,   -2.6885},//L
{ -0.263681, -0.278052,  -1.58182, -0.609867, -0.272907,  -3.12161,  -3.61241,   -4.0501,  -4.09637,  -2.92275,  0.565183, -0.133009,   7.52201,  -2.63796,  -2.82519,   -4.6789, -0.455669, -0.577169,  0.911457, -0.155585,  -3.90493,  -5.30574,  -3.30151,  -2.19103, -0.997733,   1.40202,  -1.09096,  -1.53159,   1.17921,  -3.08915,  -4.12205,  -2.85461,  -1.40119,  -1.89005,  -3.82867,  -5.61594,  -3.80398,  -5.22994,   -4.3286,  -2.44168,  -2.66766,  -2.98856,  -1.70712,   -1.2143,  -1.59903,  -1.40924,  0.214243,-0.0528597, -0.132688,  -1.95394,  -3.13879,   3.16105,  -2.09511,  -2.76135,    3.1401},//M
{    -0.523,  -5.69079,  -6.36616,  -2.74774, -0.307577,  -1.10233, -0.868897,   -1.6889,  -2.38775,  -1.45612,  -1.64096,  -3.59091,  -2.63796,   5.22775, -0.637651,  -2.68589, -0.934976,   -1.8969,  -1.29843,   -2.6552, -0.954208,  -2.51237,  -1.34875,  -1.58924,  -3.81168,  -3.45323,  -1.47762,  -3.07973,   -2.2322,  0.121997,  -0.54795, -0.385042,  -1.10083,  -2.11516,   1.08625,  -3.07413, -0.895351, -0.871987,   -1.6975,  -1.18248,  -0.41795, -0.678765, -0.510506,  -1.79263,  -1.24943,  -2.07262,  -2.31558,  -2.54116,   -2.5397,  -1.64859,  -2.61783,  -4.11235, -0.498575,  -2.85041,  -3.41288},//N
{ -0.589897,  -1.78762,  -4.27709,  -2.62089,   1.44813,  0.033079, -0.929896,   1.22392, -0.788599, -0.760489,  0.911373,  -2.08763,  -2.82519, -0.637651,   14.1465,   3.29836,   2.85772, -0.724545,  -1.90543,  -3.25623,  0.986448,   -2.8925, -0.899008,   -1.5744,   -4.1558,  -2.06738,  0.629205,  -1.10116, -0.579189,   3.11514, -0.597271, -0.631528, -0.385605,  0.308544,   3.65003,  -1.24612,  -0.69024,   2.16913,  0.487749,  0.427359, -0.465241,  -1.79786,  -2.53313, -0.322386, -0.759434,   -2.5444,  -1.91358,  -3.92575,  -2.56485,   3.96782, -0.399558,  -3.41149,   5.30184, -0.329634, -0.704535},//O
{ -0.366575,  -6.24416,  -4.03771,  -3.18183,  -3.03039,  0.545603,  -1.76896,  -2.16573,-0.0926523,  -1.09074,  -4.36568,  0.770579,   -4.6789,  -2.68589,   3.29836,   11.5466,   2.13981,  -2.44341,  -3.85105,   -2.6092,  0.453604,  -0.17725, -0.458241,   -4.6313,  -2.39232,  -3.01698,  -3.04521,  -1.80187,  -1.95205,  -1.34611,   1.23401,  -1.14473,  -1.84857,  -0.23403, -0.384823,   2.48432, -0.846735,   -2.0451,   0.56086, -0.712435,  -2.87505,  -1.47279,  -3.13636,  -2.50686,  -1.87276,  -1.83045,  -4.22266,  -2.69451,  -3.60531, -0.982598, -0.579179,  -5.54556,  -1.11072,   1.87629,   -2.4358},//P
{  -1.24462,  -4.20465,  -4.28319,  -2.45334,  -1.77726,  -1.10866, -0.280569, -0.839336, -0.484018,  0.792935,    -1.971, -0.377352, -0.455669, -0.934976,   2.85772,   2.13981,   9.14357, -0.630146,  -3.60816,  -2.08388,  -1.47691,  -2.52719,-0.0348377,  -4.01649,  -4.15481,  -1.79875,  -2.15723,  -2.87913, -0.784285, -0.462689, 0.0920206,   2.54298,  -0.44991,  -1.61478,  0.138438, -0.826351,   1.43422,  -2.07243,  -1.16144,  0.870859,  -1.58205,  0.627509, -0.664628, -0.594114, -0.857463, -0.674461,   -3.4684,  -3.35275,  -1.65764,  -1.91293,  -2.93007,  -1.55329,  -1.36889,  -1.84182,    1.1887},//Q
{  -1.01733,  -1.08653,  -4.06757, -0.416104,  -2.03189,  -2.50656,  -2.08801,  -2.50672,  -2.95383,  -2.62731,   1.79822,   1.38048, -0.577169,   -1.8969, -0.724545,  -2.44341, -0.630146,   9.86776,   3.55399,   2.79284,  -1.21516,  -3.25239,  -2.18958,   1.40979, -0.338827,   2.34496,   3.87753, 0.0671554,  0.994632, -0.804468,  -1.17044,  -2.21803,  -2.72968,  -2.64568, -0.988909,  -2.79847,  -1.69874,  -2.12465,  -1.39763,  -1.52534,  -2.00176,  -1.21235,  -2.33758, -0.546011,  0.536394,  -2.34775,   1.32698,  0.367974,   4.16776,   1.77563,  -2.82697,  -2.87909, -0.309139, -0.873792,  -1.60106},//R
{ -0.542472,  -3.85402,  -4.59938,  -3.58651,  -3.21678,   -2.5511,  -2.11425,  -2.90699,  -3.48145,  -2.85023, -0.295748,   1.20909,  0.911457,  -1.29843,  -1.90543,  -3.85105,  -3.60816,   3.55399,    10.525,   1.74083,   -3.6393,  -3.12745,  -2.75486, -0.467088,   1.37023, -0.124667,   1.72884,    1.6922,   1.10459,  -3.19328,  -2.07384,  -3.76698,  0.991549,  -2.94313,  -4.10988,  -3.70129,  -3.96703,  -3.88634,  -2.59902,  -2.30587,  -2.07202,  0.474542,  -2.17957,    -3.244,  -0.80795,  -3.07409,   3.26548, 0.0437754,   1.70282,-0.0552661,  -1.70196, -0.628497,  0.797489,  0.868102,  -1.79454},//S
{  -1.17683,  -5.86721,  -3.61591, -0.519116,  -4.33214,   -3.6773,  -3.14941,  -2.90047,  -2.52579,  -3.41412, -0.683873,-0.0877617, -0.155585,   -2.6552,  -3.25623,   -2.6092,  -2.08388,   2.79284,   1.74083,   6.22226,  -3.74872,  -2.44419,  -2.14695,   -1.3841,  0.959535,   2.10429,   2.27008,   1.85674,   2.91823,   -3.8788,  -3.16004,  -2.93508,  -4.45658,  -4.10713,  -4.04227,  -2.58905,  -2.95786,  -4.75077,  -1.73381,  -2.51006,  -3.45413,  -2.78833,  -3.28168,  -2.69084,   -1.7206, -0.885425, 0.0916551,   2.65163,   0.12415,  -2.72785,  -2.35297,  -2.91017,  -2.87414,  -1.50835,   -1.0868},//T
{ -0.619156,  -4.08167,  -6.65841,  -2.34691, -0.566338, -0.770551, -0.931346,   1.26958,  0.584527,  0.653289,  -3.05715,  -2.39202,  -3.90493, -0.954208,  0.986448,  0.453604,  -1.47691,  -1.21516,   -3.6393,  -3.74872,    7.6327,   4.03183,   3.86933,  -2.88927,  -3.38719,  -3.09273,  -1.24072,  -2.91685,  -2.58826,   1.12978,   1.00379,  0.968023, -0.461341,  0.779482,   1.13848,  0.328725,  0.738126,    3.8562,    2.0953,   1.48581, 0.0704388,  -1.04829, -0.442099,   0.16883,  -0.37796,  -1.33796,  -1.59932,   -2.8679,  -1.04082,  -1.28832,  -3.64902,  -3.11206,  -1.02028,  -2.74276,  -4.84774},//U
{ -0.856383,  -9.35301,  -6.28973,  -4.77542,  -3.09523,  -2.04867,  -1.14325, -0.320017,   1.60628,  0.236321,  -5.88776,  -2.65087,  -5.30574,  -2.51237,   -2.8925,  -0.17725,  -2.52719,  -3.25239,  -3.12745,  -2.44419,   4.03183,   6.24695,   3.03503,  -4.04491,  -1.31786,  -3.33813,  -3.19191,  -1.27701,  -2.67476,  -1.48156,   1.83257,  0.757872,  -1.55224,-0.0953997, -0.676246,   1.78701, -0.269859,   3.13822,   2.95592,   1.27295,  -1.05143, -0.363932, -0.600494, -0.325363, -0.219209,  0.775571,  -1.40081,  -1.08518,  -1.57012,  -4.03937,  -3.04103,  -4.07383,  -5.98926,  -2.50422,  -5.52975},//V
{  -0.84729,  -6.27927,  -6.90186,   -3.6374,   -1.8027, -0.846579, -0.338489,  -0.12639,  0.538962,  0.612041,  -5.78102,   -3.3524,  -3.30151,  -1.34875, -0.899008, -0.458241,-0.0348377,  -2.18958,  -2.75486,  -2.14695,   3.86933,   3.03503,   5.99769,  -4.37223,  -3.68245,  -1.99565,  -1.99222,  -2.48591, -0.519257,  0.172618, 0.0573836,   1.09835,  -1.41201, -0.391053, -0.304468, -0.642827,   2.22915,  0.387129,  0.623192,   2.38589, -0.857363,  -1.52863, -0.263852, 0.0252927, -0.922204, -0.836933,  -2.02559,  -2.50654,  -2.19074,  -4.40205,  -3.72361,  -1.92123,  -5.43984,   -3.3563,  -2.99159},//W
{ -0.520294,  -4.44116,  -6.32584,  -5.41625,  -2.76361,  -2.12621,  -5.59245,  -3.10019,  -3.39113,  -2.21034,  0.905025,  -2.30898,  -2.19103,  -1.58924,   -1.5744,   -4.6313,  -4.01649,   1.40979, -0.467088,   -1.3841,  -2.88927,  -4.04491,  -4.37223,   9.97375,   4.20499,   2.95132,   6.66795,    5.2495,  -1.70842,  -2.25998,  -4.07715,  -4.76521,  -4.25783,  -3.71736,  -2.80978,  -2.53907,   -2.6624,  -2.11942,  -2.26005,  -3.66906,  -2.43912,  -1.32313,   1.43006,  -3.03775,  -2.14551,  -2.14873,   1.54927,    1.7849,   2.43913,  0.182465,  -2.09496,  -5.00718,   1.02704,  -2.61402,  -2.87675},//X
{  -1.45941,  -5.73266,  -1.94781,  -1.19273,  -5.05887,  -2.27353,  -4.71034,  -3.98584,  -2.23563,   -3.3065,  -2.00769,   2.12914, -0.997733,  -3.81168,   -4.1558,  -2.39232,  -4.15481, -0.338827,   1.37023,  0.959535,  -3.38719,  -1.31786,  -3.68245,   4.20499,   6.66395,   1.29971,   2.26064,   4.88659,  0.761028, -0.647401,  -2.73013,  -3.50558,  -3.25389,  -3.81938,  -3.11976,  -1.58229,   -2.0494,  -3.20203, -0.415135,  -2.55713,  -3.17422,  -2.29511,  -1.09356,  -3.42175,  -2.54786,  -1.58807,   3.00941,   1.11642,  0.593578,     -2.81,   2.75332,  -3.34813,  -3.66979, -0.355553,  -2.95318},//Y
{  -1.38201,  -6.06519,  -4.56902, -0.111905,  -3.17726,  -3.13669,  -3.82743,      -3.8,  -3.16181,  -2.42944,  -2.39897, -0.970875,   1.40202,  -3.45323,  -2.06738,  -3.01698,  -1.79875,   2.34496, -0.124667,   2.10429,  -3.09273,  -3.33813,  -1.99565,   2.95132,   1.29971,   5.44308,   1.78096,  0.624357,   2.84997,  -2.31535,  -2.99243,  -2.93631,  -2.58916, -0.328165,   -2.2212,  -2.33953,  -1.00668,   -1.9611,  -1.82214, -0.643545,  -3.25005,  -2.26448,  -1.80056, -0.943132,  -1.63957,  -1.89624, -0.604949,  0.606606,   1.58681,  -2.12193,  0.588428,  -2.43688,  -3.78244, -0.672725,  -1.33601},//Z
{  -1.25644,  -2.37246,   -4.8667,   -1.8837,  -2.70905,  -3.78095,   -3.7552,  0.478879,  -2.26274,  -1.59684,   1.41431,  -2.06643,  -1.09096,  -1.47762,  0.629205,  -3.04521,  -2.15723,   3.87753,   1.72884,   2.27008,  -1.24072,  -3.19191,  -1.99222,   6.66795,   2.26064,   1.78096,   11.0535,   6.51784,   4.84621, -0.777216,  -2.99687,  -3.02203,  -2.71967,  -2.44218, -0.193266,  -2.64827,  -1.15837,  -1.34941,  -2.43076,  -1.87371,  -1.96016, -0.793523,-0.0703301,  -1.09852,  0.207757, -0.641471,  0.885936,  -0.62621,  0.820553,   2.38001,  -3.37966,  -3.82209,   3.81614,  -1.22349, -0.993719},//a
{ -0.662174,  -6.00596,   -2.7016,  -1.38403,  -4.13257,  -2.98349,  -2.63152,   -2.9214,  -1.51514,  -2.50653,  -1.90103,   2.11074,  -1.53159,  -3.07973,  -1.10116,  -1.80187,  -2.87913, 0.0671554,    1.6922,   1.85674,  -2.91685,  -1.27701,  -2.48591,    5.2495,   4.88659,  0.624357,   6.51784,   9.32981,   5.08421,  -2.99759,  -2.58906,  -3.68218,   -3.9648,  -3.35454,  -3.32234,  -1.60744,  -2.48652,  -3.79028, -0.927388,  -2.20145,  -3.27992,  -2.72766,  -3.02812,   -2.8855,  -1.73974, -0.678751,  0.676229,  0.911506, -0.965162, -0.230699, -0.403073,  -2.01574,  -2.11399,  0.641224,  -2.55563},//b
{  -1.30431,  -6.36284,  -5.08329,   1.16089,  -3.20498,  -3.19996,  -2.81867,   -2.5541,  -1.71169,  -1.74946,   -1.2553, -0.878482,   1.17921,   -2.2322, -0.579189,  -1.95205, -0.784285,  0.994632,   1.10459,   2.91823,  -2.58826,  -2.67476, -0.519257,  -1.70842,  0.761028,   2.84997,   4.84621,   5.08421,   8.53862,  -2.93627,  -2.96156,  -2.25517,    -2.733,  -3.20762,  -1.55977,   -2.4181, -0.509607,  -3.27787,  -2.07924,  -1.08728,  -3.55641,  -3.52525,  -2.63568, -0.564638,  -1.34452,  -1.08627,  -1.23883,  0.497294, -0.123844,  -2.73439,  -1.18064,  -1.05199,  -3.19105,  -1.04499,  -1.00084},//c
{  -1.54496,  -1.90371,  -3.49918,  -2.11154,   4.32471,   0.58073, -0.548396,  0.304894, -0.939391, -0.877363,  -1.39781,  -3.49419,  -3.08915,  0.121997,   3.11514,  -1.34611, -0.462689, -0.804468,  -3.19328,   -3.8788,   1.12978,  -1.48156,  0.172618,  -2.25998, -0.647401,  -2.31535, -0.777216,  -2.99759,  -2.93627,   9.82376,    3.0232,   2.55271,  -1.35911, -0.990796, -0.510577,  -2.40623,  -1.71598, -0.136762,  -1.85904, -0.515714,   2.23864,  0.371317,  0.280375,   2.05214,  0.077157,  -1.88764,  -1.69477,  -2.79582,  -1.07358,   0.77778,  -3.05896,  -4.50385,   1.54493,  -1.32216,  -1.88146},//d
{ -0.710108,  -4.21859,  -3.52943,  -1.56858, -0.309682,   3.46123, -0.969777,   -1.5984, -0.364481,  -1.22712,  -2.17315,  -1.15262,  -4.12205,  -0.54795, -0.597271,   1.23401, 0.0920206,  -1.17044,  -2.07384,  -3.16004,   1.00379,   1.83257, 0.0573836,  -4.07715,  -2.73013,  -2.99243,  -2.99687,  -2.58906,  -2.96156,    3.0232,   8.19907,   3.11102,  -2.28276,  -1.74536,-0.0531694,  0.184626, -0.402194,  -1.37385, -0.505918,  0.325689,-0.0572079,    1.1613,  0.060156,  0.794182,  0.981874, -0.500074,  -3.90443,  -3.67625,  -2.85659,  -2.24742,  -2.73883,  -3.66281,  -1.35772,  0.190227,  -1.71146},//e
{  -1.85873, -0.740854,  -1.96243,  -1.99305, -0.641163, -0.765591,    1.4584, -0.816637,  0.215488,-0.0163272,  -2.52992,  -3.61917,  -2.85461, -0.385042, -0.631528,  -1.14473,   2.54298,  -2.21803,  -3.76698,  -2.93508,  0.968023,  0.757872,   1.09835,  -4.76521,  -3.50558,  -2.93631,  -3.02203,  -3.68218,  -2.25517,   2.55271,   3.11102,   6.63744,  -3.06949,  -2.49289, -0.286005, -0.594504,-0.0106791,  -1.81815, -0.859181,  0.148368, -0.165709, -0.851418,  0.527798,  0.495087, -0.396317,  -0.58906,   -3.4942,  -2.40514,  -2.21154,  -3.34571,   -5.2091,   1.89094,  -3.12581,  -2.52559, -0.660553},//f
{ -0.599115,  -6.23108,  -5.91844,  -4.23194,  -1.66849,  -1.64122,  -1.18925,  -1.52581,  -1.86291, -0.260025,  -4.27902,  -2.08128,  -1.40119,  -1.10083, -0.385605,  -1.84857,  -0.44991,  -2.72968,  0.991549,  -4.45658, -0.461341,  -1.55224,  -1.41201,  -4.25783,  -3.25389,  -2.58916,  -2.71967,   -3.9648,    -2.733,  -1.35911,  -2.28276,  -3.06949,   7.58945,   5.17096,  -2.01006,  -2.99895,  -2.06145,  -2.11017, -0.843757,  -1.96306,  -1.22008,  -1.60546,  -1.27581,  -1.20595,  -1.72323,  -2.76896,  -2.47553,  -2.66355,  -1.79201,  -2.17398,  -3.71978,  -5.27724,  -3.37887,  -2.94837,  -2.59301},//g
{ -0.587776,  -6.44222,  -5.73614,  -3.55707,  -1.37151,    -1.802, -0.457086,  -1.14616,  -1.17278,  -1.27195,  -4.68945,  -2.73383,  -1.89005,  -2.11516,  0.308544,  -0.23403,  -1.61478,  -2.64568,  -2.94313,  -4.10713,  0.779482,-0.0953997, -0.391053,  -3.71736,  -3.81938, -0.328165,  -2.44218,  -3.35454,  -3.20762, -0.990796,  -1.74536,  -2.49289,   5.17096,   7.13753, -0.836462,  -1.54709,   -1.3114,  -1.82691,  -1.01283,  -1.11301, -0.768684,  -1.64655,  -1.54904,  0.447978,  -1.32804,  -2.41312,  -2.35497,  -2.61189,  -1.42083,  -1.42989,  -3.89825,  -5.25807,  -3.67711,  -3.09144,  -3.77799},//h
{ -0.542945,  -5.09919,  -7.36203,  -3.08448, -0.959962,  0.013647,  -0.93244,   1.63978,  0.427558, -0.268439, 0.0904811,  -1.02917,  -3.82867,   1.08625,   3.65003, -0.384823,  0.138438, -0.988909,  -4.10988,  -4.04227,   1.13848, -0.676246, -0.304468,  -2.80978,  -3.11976,   -2.2212, -0.193266,  -3.32234,  -1.55977, -0.510577,-0.0531694, -0.286005,  -2.01006, -0.836462,   8.66726,   3.69561,   4.56132,   1.69199,   1.57806,  -1.34241,  0.480239, -0.698069,  -1.33339, -0.891721, -0.502244, -0.235896,  -2.15373,  -2.54857,  -2.27165,   2.18934,  -4.48393,  -4.58324, -0.138996,  -3.43661,  -5.42806},//i
{ -0.378522,   -5.8512,  -6.16515,  -5.02358,  -2.58651, -0.863165,  -1.12949, -0.299036,   1.94845, 0.0606709,  -4.53017,  -2.09141,  -5.61594,  -3.07413,  -1.24612,   2.48432, -0.826351,  -2.79847,  -3.70129,  -2.58905,  0.328725,   1.78701, -0.642827,  -2.53907,  -1.58229,  -2.33953,  -2.64827,  -1.60744,   -2.4181,  -2.40623,  0.184626, -0.594504,  -2.99895,  -1.54709,   3.69561,   8.37317,   3.02533,   3.29921,   1.14319,  -1.36201,  -1.66215,  -2.09618,  -2.16448,  -2.21781,  -1.17166, 0.0972668,  -3.06206,  -2.49996,  -3.26601,  -3.27845,  -3.12889,  -5.52805,  -4.04867,   -2.5009,  -4.33091},//j
{  -1.12827,  -5.27616,  -6.47549,  -3.92134, -0.461428,-0.0515525,  0.579513,  0.710169,  0.865648,   2.18072,  -3.44047,  -2.77261,  -3.80398, -0.895351,  -0.69024, -0.846735,   1.43422,  -1.69874,  -3.96703,  -2.95786,  0.738126, -0.269859,   2.22915,   -2.6624,   -2.0494,  -1.00668,  -1.15837,  -2.48652, -0.509607,  -1.71598, -0.402194,-0.0106791,  -2.06145,   -1.3114,   4.56132,   3.02533,   6.29426,   -0.8135, -0.169106,  0.874824, -0.278041,  -1.33676, -0.615954, -0.167452,  -1.33509, -0.943483,  -2.96453,  -2.20018,  -2.34098,  -3.86722,  -3.24345,  -3.60843,  -3.53474,  -1.97326,  -3.37984},//k
{ -0.380895,  -5.60902,    -6.526,  -4.00291, -0.758728,  -1.97371,  -2.31426, -0.443492,  -1.19853,  -1.23447,  -3.60017,  -3.56285,  -5.22994, -0.871987,   2.16913,   -2.0451,  -2.07243,  -2.12465,  -3.88634,  -4.75077,    3.8562,   3.13822,  0.387129,  -2.11942,  -3.20203,   -1.9611,  -1.34941,  -3.79028,  -3.27787, -0.136762,  -1.37385,  -1.81815,  -2.11017,  -1.82691,   1.69199,   3.29921,   -0.8135,   9.84862,   4.56879,   4.54059, -0.811459,   -1.3392,  -2.12426,  -1.74116,  -1.19264,  -3.36877,  -2.05341,  -4.77351,  -2.32625,  0.329922,  -2.76748,  -4.73639,   1.47262,  -2.47774,  -4.19188},//l
{  -0.40113,  -1.16259,  -2.32323,  -2.95476,  -2.05436, -0.803408,  -1.12138, -0.856816,   1.54876,  0.234219,  -4.51958,  -1.63225,   -4.3286,   -1.6975,  0.487749,   0.56086,  -1.16144,  -1.39763,  -2.59902,  -1.73381,    2.0953,   2.95592,  0.623192,  -2.26005, -0.415135,  -1.82214,  -2.43076, -0.927388,  -2.07924,  -1.85904, -0.505918, -0.859181, -0.843757,  -1.01283,   1.57806,   1.14319, -0.169106,   4.56879,   7.10942,   3.43505,  -1.09389, -0.738667, -0.897443,  -2.08448, -0.541614, -0.259168,  -1.18481,  -2.37009,  -1.96328,-0.0021945,   0.47104,  -4.10294,  -1.76166, -0.305632,  -3.17615},//m
{ -0.892847,  -5.31862,  -5.79972,  -1.76834, -0.587561, -0.593555, -0.507812,  -0.89532,  0.365061,  0.388812,  -3.40334,  -2.57278,  -2.44168,  -1.18248,  0.427359, -0.712435,  0.870859,  -1.52534,  -2.30587,  -2.51006,   1.48581,   1.27295,   2.38589,  -3.66906,  -2.55713, -0.643545,  -1.87371,  -2.20145,  -1.08728, -0.515714,  0.325689,  0.148368,  -1.96306,  -1.11301,  -1.34241,  -1.36201,  0.874824,   4.54059,   3.43505,   6.93693,  -1.31412, -0.426947, -0.670781, -0.304225,  -1.36255,  -1.80606,  -3.15457,  -3.05118,  -2.12407,  -1.35102,  -1.80848,  -2.98419,  -3.07462,  -1.68883,  -1.15507},//n
{ -0.707997,  -3.63179,  -4.22682,  -2.81874,   0.87419,  0.436727,  -0.78156,0.00920898,  -1.46387, -0.536578,  -1.22467,   -2.5724,  -2.66766,  -0.41795, -0.465241,  -2.87505,  -1.58205,  -2.00176,  -2.07202,  -3.45413, 0.0704388,  -1.05143, -0.857363,  -2.43912,  -3.17422,  -3.25005,  -1.96016,  -3.27992,  -3.55641,   2.23864,-0.0572079, -0.165709,  -1.22008, -0.768684,  0.480239,  -1.66215, -0.278041, -0.811459,  -1.09389,  -1.31412,   4.78748,   2.60349,   2.39347,   2.07215,  0.290773,-0.0392416,  -1.73428,  -2.80035, -0.623004,  -0.57415,  -3.01812,  -4.03375,  -1.33627,  -1.91841,  -2.99184},//o
{ -0.576223,  -5.34387,  -2.48423,  -2.22222,  -1.03011,   1.45142,  -1.18253,  -1.37553,  -1.68082,  -1.34248,  -2.40103,  -1.15618,  -2.98856, -0.678765,  -1.79786,  -1.47279,  0.627509,  -1.21235,  0.474542,  -2.78833,  -1.04829, -0.363932,  -1.52863,  -1.32313,  -2.29511,  -2.26448, -0.793523,  -2.72766,  -3.52525,  0.371317,    1.1613, -0.851418,  -1.60546,  -1.64655, -0.698069,  -2.09618,  -1.33676,   -1.3392, -0.738667, -0.426947,   2.60349,   6.31911,   2.29648, -0.293783,    1.5949, 0.0375049,  -2.43195,  -2.81712,  -1.96849,  -3.11943,  -3.88909,  -3.20817,  -1.59826,  -1.24873,  -1.79821},//p
{-0.0667358,  -5.15304,  -4.45388,    -1.333,  -1.12771,  -1.21531, -0.354934,  -1.57104,   -1.3721,  -1.42728,  -3.01157,  -3.24697,  -1.70712, -0.510506,  -2.53313,  -3.13636, -0.664628,  -2.33758,  -2.17957,  -3.28168, -0.442099, -0.600494, -0.263852,   1.43006,  -1.09356,  -1.80056,-0.0703301,  -3.02812,  -2.63568,  0.280375,  0.060156,  0.527798,  -1.27581,  -1.54904,  -1.33339,  -2.16448, -0.615954,  -2.12426, -0.897443, -0.670781,   2.39347,   2.29648,   4.99933,  0.689359,  0.451384,   1.46449,  -2.05742,  -2.46315,  -2.20729,  -2.65193,  -4.40005,  -2.81489,  -1.48044,  -2.29529,  -1.33199},//q
{  -1.21754,  -3.27618,   -2.4155,  -2.08366,   1.31917,  -1.30207,  -1.67496,  -1.42442,  -2.13539,  -1.31784,  -3.67927,  -3.69904,   -1.2143,  -1.79263, -0.322386,  -2.50686, -0.594114, -0.546011,    -3.244,  -2.69084,   0.16883, -0.325363, 0.0252927,  -3.03775,  -3.42175, -0.943132,  -1.09852,   -2.8855, -0.564638,   2.05214,  0.794182,  0.495087,  -1.20595,  0.447978, -0.891721,  -2.21781, -0.167452,  -1.74116,  -2.08448, -0.304225,   2.07215, -0.293783,  0.689359,   5.57849,   3.09082,   2.03063,  -0.86745,  -1.77618, -0.331996, -0.849264,  -3.69531,  -3.26472,  -2.28155,  -2.45702,  -1.57053},//r
{  -0.84387,  -2.59388,   -3.6858,  -3.09499, -0.987373,  -0.63213,  -2.34843,  -1.40657,  -1.75433,  -2.30724,  -1.74178,  -2.15676,  -1.59903,  -1.24943, -0.759434,  -1.87276, -0.857463,  0.536394,  -0.80795,   -1.7206,  -0.37796, -0.219209, -0.922204,  -2.14551,  -2.54786,  -1.63957,  0.207757,  -1.73974,  -1.34452,  0.077157,  0.981874, -0.396317,  -1.72323,  -1.32804, -0.502244,  -1.17166,  -1.33509,  -1.19264, -0.541614,  -1.36255,  0.290773,    1.5949,  0.451384,   3.09082,    7.9829,   3.83563, -0.115838,   -1.1249, -0.438123,  -1.55673,  -3.63231,  -3.79253,  -1.63633,  -2.29402,  -1.06468},//s
{ -0.793213,  -6.99954,  -2.77351,  -2.76545,  -2.72215,  -2.41821,  -1.18159, -0.261627,  -0.34583,  -1.37169,  -4.37346,  -2.44832,  -1.40924,  -2.07262,   -2.5444,  -1.83045, -0.674461,  -2.34775,  -3.07409, -0.885425,  -1.33796,  0.775571, -0.836933,  -2.14873,  -1.58807,  -1.89624, -0.641471, -0.678751,  -1.08627,  -1.88764, -0.500074,  -0.58906,  -2.76896,  -2.41312, -0.235896, 0.0972668, -0.943483,  -3.36877, -0.259168,  -1.80606,-0.0392416, 0.0375049,   1.46449,   2.03063,   3.83563,   5.36564,  -0.87571,  -0.15921,  -1.23765,  -3.12164,  -3.38324,  -2.76361,  -2.28473,   -2.5527,  -1.23376},//t
{   0.53968,  -2.54156,  -3.00941,  -2.19687,  -2.70379,  -3.94435,  -2.80397,  -1.92586,  -2.74857,  -2.72093,  0.320618,  -1.42923,  0.214243,  -2.31558,  -1.91358,  -4.22266,   -3.4684,   1.32698,   3.26548, 0.0916551,  -1.59932,  -1.40081,  -2.02559,   1.54927,   3.00941, -0.604949,  0.885936,  0.676229,  -1.23883,  -1.69477,  -3.90443,   -3.4942,  -2.47553,  -2.35497,  -2.15373,  -3.06206,  -2.96453,  -2.05341,  -1.18481,  -3.15457,  -1.73428,  -2.43195,  -2.05742,  -0.86745, -0.115838,  -0.87571,   7.60409,   2.86873,   4.39951, -0.626451,  -2.82906,  -2.38582,  0.873922,  -2.57747,  -1.78918},//u
{ -0.768414,  -2.08049,  -2.12316, -0.594667,   -4.0481,  -4.05658,  -2.45356,  -2.87994,   -2.4265,  -3.10693,    -1.423, -0.988032,-0.0528597,  -2.54116,  -3.92575,  -2.69451,  -3.35275,  0.367974, 0.0437754,   2.65163,   -2.8679,  -1.08518,  -2.50654,    1.7849,   1.11642,  0.606606,  -0.62621,  0.911506,  0.497294,  -2.79582,  -3.67625,  -2.40514,  -2.66355,  -2.61189,  -2.54857,  -2.49996,  -2.20018,  -4.77351,  -2.37009,  -3.05118,  -2.80035,  -2.81712,  -2.46315,  -1.77618,   -1.1249,  -0.15921,   2.86873,   4.97646,   2.32731,   -3.1539,  -3.64647,  -1.61289,  -3.97939,  -2.45894, -0.320849},//v
{ -0.381107,   -1.7427,  -4.48156,  -1.31017,  -2.37519,  -3.40064,   -2.7005,  -1.92477,  -2.78757,  -1.62517,  0.034443,  -1.74472, -0.132688,   -2.5397,  -2.56485,  -3.60531,  -1.65764,   4.16776,   1.70282,   0.12415,  -1.04082,  -1.57012,  -2.19074,   2.43913,  0.593578,   1.58681,  0.820553, -0.965162, -0.123844,  -1.07358,  -2.85659,  -2.21154,  -1.79201,  -1.42083,  -2.27165,  -3.26601,  -2.34098,  -2.32625,  -1.96328,  -2.12407, -0.623004,  -1.96849,  -2.20729, -0.331996, -0.438123,  -1.23765,   4.39951,   2.32731,   7.26265,  -1.25997,  -3.52754,   -2.1249,  -2.04123,  -2.46198,  -1.64922},//w
{  -2.16586,  -2.89796,  -4.04859,  -3.31732,  0.254297,  -2.37397,  -3.20405,  0.689124,  -2.78234,  -3.11496,   5.08762, -0.631505,  -1.95394,  -1.64859,   3.96782, -0.982598,  -1.91293,   1.77563,-0.0552661,  -2.72785,  -1.28832,  -4.03937,  -4.40205,  0.182465,     -2.81,  -2.12193,   2.38001, -0.230699,  -2.73439,   0.77778,  -2.24742,  -3.34571,  -2.17398,  -1.42989,   2.18934,  -3.27845,  -3.86722,  0.329922,-0.0021945,  -1.35102,  -0.57415,  -3.11943,  -2.65193, -0.849264,  -1.55673,  -3.12164, -0.626451,   -3.1539,  -1.25997,   16.1043,   4.37871,   0.70504,   7.83278,   1.22669,  -2.00787},//x
{  -3.24808,  -7.84024,  -5.02397,  -4.46695,  -2.88694,  -1.78507,  -4.55336,  -3.37187,  -1.77986,  -1.37572,  -3.01818,   3.92058,  -3.13879,  -2.61783, -0.399558, -0.579179,  -2.93007,  -2.82697,  -1.70196,  -2.35297,  -3.64902,  -3.04103,  -3.72361,  -2.09496,   2.75332,  0.588428,  -3.37966, -0.403073,  -1.18064,  -3.05896,  -2.73883,   -5.2091,  -3.71978,  -3.89825,  -4.48393,  -3.12889,  -3.24345,  -2.76748,   0.47104,  -1.80848,  -3.01812,  -3.88909,  -4.40005,  -3.69531,  -3.63231,  -3.38324,  -2.82906,  -3.64647,  -3.52754,   4.37871,   12.7129,  0.331433,   1.04339,   6.80947,  -4.31757},//y
{  -3.55613,  -9.72281,  -8.35416,  -3.99073,  -2.18233,  -5.02255,  -4.05776,    -2.761,  -5.34812,  -3.27374,  -1.14988,  -2.47021,   3.16105,  -4.11235,  -3.41149,  -5.54556,  -1.55329,  -2.87909, -0.628497,  -2.91017,  -3.11206,  -4.07383,  -1.92123,  -5.00718,  -3.34813,  -2.43688,  -3.82209,  -2.01574,  -1.05199,  -4.50385,  -3.66281,   1.89094,  -5.27724,  -5.25807,  -4.58324,  -5.52805,  -3.60843,  -4.73639,  -4.10294,  -2.98419,  -4.03375,  -3.20817,  -2.81489,  -3.26472,  -3.79253,  -2.76361,  -2.38582,  -1.61289,   -2.1249,   0.70504,  0.331433,   11.0975,  -2.99302,  -2.53425,  0.479524},//z
{  -1.73313,  -3.07319,  -6.28559,  -3.23081,   0.63188, 0.0670789,   -2.0004,   2.18682,  -1.61693,   -4.3262,   8.94699, -0.733596,  -2.09511, -0.498575,   5.30184,  -1.11072,  -1.36889, -0.309139,  0.797489,  -2.87414,  -1.02028,  -5.98926,  -5.43984,   1.02704,  -3.66979,  -3.78244,   3.81614,  -2.11399,  -3.19105,   1.54493,  -1.35772,  -3.12581,  -3.37887,  -3.67711, -0.138996,  -4.04867,  -3.53474,   1.47262,  -1.76166,  -3.07462,  -1.33627,  -1.59826,  -1.48044,  -2.28155,  -1.63633,  -2.28473,  0.873922,  -3.97939,  -2.04123,   7.83278,   1.04339,  -2.99302,   11.5788,   4.27196, -0.332675},//0
{  -1.99479,  -6.44478,  -5.40876,  -3.44479,   -1.2142,  -0.53254,  -2.72427,  -2.88563,  -1.19877,  -2.69496,   1.02974,   7.38787,  -2.76135,  -2.85041, -0.329634,   1.87629,  -1.84182, -0.873792,  0.868102,  -1.50835,  -2.74276,  -2.50422,   -3.3563,  -2.61402, -0.355553, -0.672725,  -1.22349,  0.641224,  -1.04499,  -1.32216,  0.190227,  -2.52559,  -2.94837,  -3.09144,  -3.43661,   -2.5009,  -1.97326,  -2.47774, -0.305632,  -1.68883,  -1.91841,  -1.24873,  -2.29529,  -2.45702,  -2.29402,   -2.5527,  -2.57747,  -2.45894,  -2.46198,   1.22669,   6.80947,  -2.53425,   4.27196,   9.79798, -0.957744},//1
{  -2.09109,   2.69856, -0.593343,  -2.08175, -0.771218,   -3.3819,  -3.19591,  -4.87703,  -4.65681,  -3.34833,  -1.02556,   -2.6885,    3.1401,  -3.41288, -0.704535,   -2.4358,    1.1887,  -1.60106,  -1.79454,   -1.0868,  -4.84774,  -5.52975,  -2.99159,  -2.87675,  -2.95318,  -1.33601, -0.993719,  -2.55563,  -1.00084,  -1.88146,  -1.71146, -0.660553,  -2.59301,  -3.77799,  -5.42806,  -4.33091,  -3.37984,  -4.19188,  -3.17615,  -1.15507,  -2.99184,  -1.79821,  -1.33199,  -1.57053,  -1.06468,  -1.23376,  -1.78918, -0.320849,  -1.64922,  -2.00787,  -4.31757,  0.479524, -0.332675, -0.957744,   8.09597},//2
};

const string RotSeq_list=
//ACCCDDDEEEFFFGHHHIIIKKKLLLMMMNNNPPQQQRRRSSSTTTVVVWWWYYY amino acid code
//1123123123123112312312312312312312123123123123123123123 chi-1 rotamer index
 "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz012"; // jarret rotamer code

/* convert ROTSUM code to int */
inline int RotSeq2int(char aa)
{
    for (int i=0;i<RotSeq_list.length();i++)
        if (RotSeq_list[i]==aa) return i;
    //if (aa!=toupper(aa)) return RotSeq2int(toupper(aa));
    return RotSeq_list.length();
}

vector<int> RotSeq2int(const string sequence)
{
    vector<int> seq2int;
    for (int r=0;r<sequence.length();r++)
        seq2int.push_back(RotSeq2int(sequence[r]));
    return seq2int;
}

/* initialize matrix in gotoh algorith, */
void init_gotoh_mat(vector<vector<int> >&JumpH, vector<vector<int> >&JumpV,
    vector<vector<int> >& P,vector<vector<float> >& S, 
    vector<vector<float> >& H, vector<vector<float> >& V,
    const int len1, const int len2, const int gapopen,const int gapext,
    const int glocal=0, const int alt_init=1)
{
    // fill first row/colum of JumpH,jumpV and path matrix P
    int i,j;
    for (i=0;i<len1+1;i++)
    {
        if (glocal<2) P[i][0]=4; // -
        JumpV[i][0]=i;
    }
    for (j=0;j<len2+1;j++)
    {
        if (glocal<1) P[0][j]=2; // |
        JumpH[0][j]=j;
    }
    if (glocal<2) for (i=1;i<len1+1;i++) S[i][0]=gapopen+gapext*(i-1);
    if (glocal<1) for (j=1;j<len2+1;j++) S[0][j]=gapopen+gapext*(j-1);
    if (alt_init==0)
    {
        for (i=1;i<len1+1;i++) H[i][0]=gapopen+gapext*(i-1);
        for (j=1;j<len2+1;j++) V[0][j]=gapopen+gapext*(j-1);
    }
    else
    {
        if (glocal<2) for (i=1;i<len1+1;i++) V[i][0]=gapopen+gapext*(i-1);
        if (glocal<1) for (j=1;j<len2+1;j++) H[0][j]=gapopen+gapext*(j-1);
        for (i=0;i<len1+1;i++) H[i][0]=-99999; // INT_MIN cause bug on ubuntu
        for (j=0;j<len2+1;j++) V[0][j]=-99999; // INT_MIN;
    }
}

/* locate the cell with highest alignment score. reset path after
 * the cell to zero. overwriting equivalent function in NWalign.hpp when 
 * alignment score is float */
void find_highest_align_score(
    const vector<vector<float> >& S, vector<vector<int> >& P,
    float &aln_score, const int len1,const int len2)
{
    // locate the cell with highest alignment score
    int max_aln_i=len1;
    int max_aln_j=len2;
    int i,j;
    for (i=0;i<len1+1;i++)
    {
        for (j=0;j<len2+1;j++)
        {
            if (S[i][j]>=aln_score)
            {
                max_aln_i=i;
                max_aln_j=j;
                aln_score=S[i][j];
            }
        }
    }

    // reset all path after [max_aln_i][max_aln_j]
    for (i=max_aln_i+1;i<len1+1;i++) for (j=0;j<len2+1;j++) P[i][j]=0;
    for (i=0;i<len1+1;i++) for (j=max_aln_j+1;j<len2+1;j++) P[i][j]=0;
}

/* calculate dynamic programming matrix using gotoh algorithm. 
 * overwriting NWalign in NWalign.hpp when scoring matrix is float 55x55.
 *
 * S     - cumulative scorefor each cell
 * P     - string representation for path
 *         0 :   uninitialized, for gaps at N- & C- termini when glocal>0
 *         1 : \ match-mismatch
 *         2 : | vertical gap (insertion)
 *         4 : - horizontal gap (deletion)
 * JumpH - horizontal long gap number.
 * JumpV - vertical long gap number.
 * all matrices are in the size of [len(seq1)+1]*[len(seq2)+1]
 *
 * global - global or local alignment
 *         0 : global alignment (Needleman-Wunsch dynamic programming)
 *         1 : glocal-query alignment
 *         2 : glocal-both alignment
 *         3 : local alignment (Smith-Waterman dynamic programming)
 *
 * alt_init - whether to adopt alternative matrix initialization
 *         1 : use wei zheng's matrix initialization
 *         0 : use yang zhang's matrix initialization, does NOT work
 *             for glocal alignment
 */
float calculate_score_gotoh(
    const vector<int>& seq2int1, const vector<int>& seq2int2,
    vector<vector<int> >& JumpH, vector<vector<int> >& JumpV,
    vector<vector<int> >& P,const float ScoringMatrix[55][55],
    const int gapopen,const int gapext,const int glocal=0,
    const int alt_init=1)
{
    int len1=seq2int1.size();
    int len2=seq2int2.size();

    vector<float> temp_float(len2+1,0);
    vector<vector<float> > S(len1+1,temp_float);
    // penalty score for horizontal long gap
    vector<vector<float> > H(len1+1,temp_float);
    // penalty score for vertical long gap
    vector<vector<float> > V(len1+1,temp_float);
    
    // fill first row/colum of JumpH,jumpV and path matrix P
    int i,j;
    init_gotoh_mat(JumpH, JumpV, P, S, H, V, len1, len2,
        gapopen, gapext, glocal, alt_init);

    // fill S and P
    float diag_score,left_score,up_score;
    for (i=1;i<len1+1;i++)
    {
        for (j=1;j<len2+1;j++)
        {
            // penalty of consective deletion
            if (glocal<1 || i<len1 || glocal>=3)
            {
                H[i][j]=MAX(S[i][j-1]+gapopen,H[i][j-1]+gapext);
                JumpH[i][j]=(H[i][j]==H[i][j-1]+gapext)?(JumpH[i][j-1]+1):1;
            }
            else
            {
                H[i][j]=MAX(S[i][j-1],H[i][j-1]);
                JumpH[i][j]=(H[i][j]==H[i][j-1])?(JumpH[i][j-1]+1):1;
            }
            // penalty of consective insertion
            if (glocal<2 || j<len2 || glocal>=3)
            {
                V[i][j]=MAX(S[i-1][j]+gapopen,V[i-1][j]+gapext);
                JumpV[i][j]=(V[i][j]==V[i-1][j]+gapext)?(JumpV[i-1][j]+1):1;
            }
            else
            {
                V[i][j]=MAX(S[i-1][j],V[i-1][j]);
                JumpV[i][j]=(V[i][j]==V[i-1][j])?(JumpV[i-1][j]+1):1;
            }

            diag_score=S[i-1][j-1]; // match-mismatch '\'
            if (seq2int1[i-1]<55 && seq2int1[j-1]<55)
                diag_score+=ScoringMatrix[seq2int1[i-1]][seq2int2[j-1]];
            left_score=H[i][j];     // deletion       '-'
            up_score  =V[i][j];     // insertion      '|'

            if (diag_score>=left_score && diag_score>=up_score)
            {
                S[i][j]=diag_score;
                P[i][j]+=1;
            }
            if (up_score>=diag_score && up_score>=left_score)
            {
                S[i][j]=up_score;
                P[i][j]+=2;
            }
            if (left_score>=diag_score && left_score>=up_score)
            {
                S[i][j]=left_score;
                P[i][j]+=4;
            }
            if (glocal>=3 && S[i][j]<0)
            {
                S[i][j]=0;
                P[i][j]=0;
                H[i][j]=0;
                V[i][j]=0;
                JumpH[i][j]=0;
                JumpV[i][j]=0;
            }
        }
    }
    float aln_score=S[len1][len2];

    // re-fill first row/column of path matrix P for back-tracing
    for (i=1;i<len1;i++) if (glocal<3 || P[i][0]>0) P[i][0]=2; // |
    for (j=1;j<len2;j++) if (glocal<3 || P[0][j]>0) P[0][j]=4; // -

    // calculate alignment score and alignment path for swalign
    if (glocal>=3)
        find_highest_align_score(S,P,aln_score,len1,len2);

    // release memory
    S.clear();
    H.clear();
    V.clear();
    return aln_score; // final alignment score
}

/* entry function for NWalign, overwriting NWalign in NWalign.hpp when
 * scoring matrix is float 55x55 */
float NWalign(const string& seq1, const string& seq2,
    const vector<int>& seq2int1, const vector<int>& seq2int2, // aa2int
    string & aln1,string & aln2,const float ScoringMatrix[55][55],
    const int gapopen,const int gapext,const int glocal=0)
{
    int len1=seq2int1.size();
    int len2=seq2int2.size();
    vector<int> temp_int(len2+1,0);
    vector<vector<int> > JumpH(len1+1,temp_int);
    vector<vector<int> > JumpV(len1+1,temp_int);
    vector<vector<int> > P(len1+1,temp_int);

    float aln_score=calculate_score_gotoh(seq2int1,seq2int2,JumpH,JumpV,P,
        ScoringMatrix,gapopen,gapext,glocal);

    if (glocal<3)
    {
        trace_back_gotoh(seq1,seq2,JumpH,JumpV,P,aln1,aln2);
    }
    else
    {
        trace_back_sw(seq1,seq2,JumpH,JumpV,P,aln1,aln2);
    }

    JumpH.clear();
    JumpV.clear();
    P.clear();
    return aln_score; // aligment score
}

#endif
